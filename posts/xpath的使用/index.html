<!doctype html><html lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>XPath的使用</title>
<meta name=description content="XPath（XML Path Language）是一种用于在XML文档中查找和筛选信息的语言，它常用于爬虫开发中，帮助我们定位网页中的元素。XPath 是 W3C 标准，它支持路径表达式来选择 XML 或 HTML 文档中的节点。
基本语法 XPath 通过路径表达式来查找节点，基本的语法规则如下：
/：从根节点开始选 …"><meta name=keywords content='blog,hugo,XPath'><meta property="og:url" content="http://localhost:1313/posts/xpath%E7%9A%84%E4%BD%BF%E7%94%A8/"><meta property="og:type" content="website"><meta property="og:title" content="XPath的使用"><meta property="og:description" content="XPath（XML Path Language）是一种用于在XML文档中查找和筛选信息的语言，它常用于爬虫开发中，帮助我们定位网页中的元素。XPath 是 W3C 标准，它支持路径表达式来选择 XML 或 HTML 文档中的节点。
基本语法 XPath 通过路径表达式来查找节点，基本的语法规则如下：
/：从根节点开始选 …"><meta property="og:image" content="http://localhost:1313/images/cat.webp"><meta property="og:image:secure_url" content="http://localhost:1313/images/cat.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="XPath的使用"><meta name=twitter:description content="XPath（XML Path Language）是一种用于在XML文档中查找和筛选信息的语言，它常用于爬虫开发中，帮助我们定位网页中的元素。XPath 是 W3C 标准，它支持路径表达式来选择 XML 或 HTML 文档中的节点。
基本语法 XPath 通过路径表达式来查找节点，基本的语法规则如下：
/：从根节点开始选 …"><meta property="twitter:domain" content="http://localhost:1313/posts/xpath%E7%9A%84%E4%BD%BF%E7%94%A8/"><meta property="twitter:url" content="http://localhost:1313/posts/xpath%E7%9A%84%E4%BD%BF%E7%94%A8/"><meta name=twitter:image content="http://localhost:1313/images/cat.webp"><link rel=canonical href=http://localhost:1313/posts/xpath%E7%9A%84%E4%BD%BF%E7%94%A8/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.275fedb6f364c8865658bae576d82b514ace973f6a13ed63503a85b20c697453.js integrity="sha256-J1/ttvNkyIZWWLrldtgrUUrOlz9qE+1jUDqFsgxpdFM="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=http://localhost:1313/><img src=/images/cat.webp alt=cat></a></div><div class=nav-title><a class=nav-brand href=http://localhost:1313/>Merthon</a></div><div class=nav-links><div class=nav-link><a href=http://localhost:1313/ aria-label><span data-feather=home></span> Home</a></div><div class=nav-link><a href=http://localhost:1313/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=http://localhost:1313/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=http://localhost:1313/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/Merthon aria-label=github><span data-feather=github></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=http://localhost:1313/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=http://localhost:1313/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=http://localhost:1313/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=http://localhost:1313/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/Merthon><span data-feather=github></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>XPath的使用</h1><small role=doc-subtitle></small><p class=post-date>January 12, 2025</p><ul class=post-tags><li class=post-tag><a href=http://localhost:1313/tags/xpath>XPath</a></li></ul></div><div class=post-content><p>XPath（XML Path Language）是一种用于在XML文档中查找和筛选信息的语言，它常用于爬虫开发中，帮助我们定位网页中的元素。XPath 是 W3C 标准，它支持路径表达式来选择 XML 或 HTML 文档中的节点。</p><h1 id=基本语法>基本语法</h1><p>XPath 通过路径表达式来查找节点，基本的语法规则如下：</p><ul><li><code>/</code>：从根节点开始选取。</li><li><code>//</code>：选取文档中所有符合条件的节点，而不考虑它们的位置。</li><li><code>.</code>：当前节点。</li><li><code>..</code>：父节点。</li><li><code>@</code>：选择属性。</li></ul><h3 id=常见的-xpath-表达式>常见的 XPath 表达式</h3><ol><li><strong>选择根节点</strong>：<ul><li><code>/</code>: 选取文档的根节点。</li><li>例如：<code>/html</code> 选取 <code>&lt;html></code> 元素。</li></ul></li><li><strong>选择某个子节点</strong>：<ul><li><code>/parent/child</code>: 选取父节点下的子节点。</li><li>例如：<code>/html/body/div</code> 选取 <code>&lt;div></code> 元素。</li></ul></li><li><strong>选择所有子节点</strong>：<ul><li><code>/parent/*</code>: 选取父节点下的所有子节点。</li><li>例如：<code>/html/body/*</code> 选取 <code>&lt;body></code> 下的所有子元素。</li></ul></li><li><strong>选择所有符合条件的节点（不管位置）</strong>：<ul><li><code>//element</code>: 在整个文档中查找所有的 <code>element</code> 节点。</li><li>例如：<code>//div</code> 选取所有的 <code>&lt;div></code> 元素。</li></ul></li><li><strong>选择属性</strong>：<ul><li><code>@attribute</code>: 选取某个节点的属性。</li><li>例如：<code>//a/@href</code> 选取所有 <code>&lt;a></code> 标签的 <code>href</code> 属性。</li></ul></li><li><strong>选择带特定属性的节点</strong>：<ul><li><code>//element[@attribute='value']</code>: 选择属性为特定值的元素。</li><li>例如：<code>//a[@class='link']</code> 选取所有 <code>class</code> 为 <code>link</code> 的 <code>&lt;a></code> 标签。</li></ul></li><li><strong>使用逻辑运算符</strong>：<ul><li><code>and</code>: 用于多个条件的组合。</li><li><code>or</code>: 或者关系。</li><li>例如：<code>//a[@class='link' and @href]</code> 选取所有 <code>class</code> 为 <code>link</code> 并且有 <code>href</code> 属性的 <code>&lt;a></code> 标签。</li></ul></li><li><strong>选择文本内容</strong>：<ul><li><code>text()</code>: 选取文本内容。</li><li>例如：<code>//h1/text()</code> 选取所有 <code>&lt;h1></code> 标签中的文本。</li></ul></li><li><strong>选择特定位置的元素</strong>：<ul><li><code>[index]</code>: 用来选择特定位置的元素，索引从 1 开始。</li><li>例如：<code>//ul/li[1]</code> 选取第一个 <code>&lt;li></code> 元素。</li><li><code>last()</code>: 选择最后一个元素。</li><li>例如：<code>//ul/li[last()]</code> 选取最后一个 <code>&lt;li></code> 元素。
实例：</li></ul></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>h1</span>&gt;Example Title&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;content&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>p</span>&gt;First paragraph.&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;special&#34;</span>&gt;Second paragraph.&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>p</span>&gt;Third paragraph.&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://example.com&#34;</span>&gt;Link&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>选取所有的 <code>&lt;p></code> 标签：<code>//p</code>
选取具有 <code>class='special'</code> 的 <code>&lt;p></code> 标签：<code>//p[@class='special']</code>
选取 <code>&lt;h1></code> 中的文本内容：<code>//h1/text()</code>
选取 <code>&lt;a></code> 标签的 <code>href</code> 属性：<code>//a/@href</code>
选取 <code>div</code> 标签中的第一个 <code>&lt;p></code> 标签：<code>//div/p[1]</code></p><h2 id=在-python-中使用-xpath>在 Python 中使用 XPath</h2><p>在 Python 中，常用的库有 <code>lxml</code> 和 <code>BeautifulSoup</code>，其中 <code>lxml</code> 提供了对 XPath 的支持。
使用 <code>lxml</code> 库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> lxml <span style=color:#f92672>import</span> html
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 假设你已经获得了网页内容，并将其作为字符串</span>
</span></span><span style=display:flex><span>page_content <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;html&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &lt;body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;h1&gt;Example Title&lt;/h1&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;div class=&#34;content&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;p&gt;First paragraph.&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;p class=&#34;special&#34;&gt;Second paragraph.&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;p&gt;Third paragraph.&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;a href=&#34;http://example.com&#34;&gt;Link&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &lt;/body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;/html&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tree <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>fromstring(page_content)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 XPath 获取所有 &lt;p&gt; 标签的文本</span>
</span></span><span style=display:flex><span>p_texts <span style=color:#f92672>=</span> tree<span style=color:#f92672>.</span>xpath(<span style=color:#e6db74>&#39;//p/text()&#39;</span>)
</span></span><span style=display:flex><span>print(p_texts)  <span style=color:#75715e># 输出：[&#39;First paragraph.&#39;, &#39;Second paragraph.&#39;, &#39;Third paragraph.&#39;]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 XPath 获取 class 为 &#39;special&#39; 的 &lt;p&gt; 标签的文本</span>
</span></span><span style=display:flex><span>special_p <span style=color:#f92672>=</span> tree<span style=color:#f92672>.</span>xpath(<span style=color:#e6db74>&#34;//p[@class=&#39;special&#39;]/text()&#34;</span>)
</span></span><span style=display:flex><span>print(special_p)  <span style=color:#75715e># 输出：[&#39;Second paragraph.&#39;]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 XPath 获取 &lt;a&gt; 标签的 href 属性</span>
</span></span><span style=display:flex><span>href <span style=color:#f92672>=</span> tree<span style=color:#f92672>.</span>xpath(<span style=color:#e6db74>&#39;//a/@href&#39;</span>)
</span></span><span style=display:flex><span>print(href)  <span style=color:#75715e># 输出：[&#39;http://example.com&#39;]</span>
</span></span></code></pre></div></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#基本语法>基本语法</a><ul><li><ul><li><a href=#常见的-xpath-表达式>常见的 XPath 表达式</a></li></ul></li><li><a href=#在-python-中使用-xpath>在 Python 中使用 XPath</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 Merthon</span>
<span>Made with &#10084;&#65039; Hugo</span></footer></body></html>